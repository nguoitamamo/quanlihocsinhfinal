{% extends 'admin/base.html' %}
{% block head %}
    <!-- You can add the Bootstrap CSS in the head block -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}


{% block body %}
    <div style = "display: flex; justify-content: space-between">
        <h3>Danh sách Môn học</h3>
        <form action="{{ url_for('.timkiem_monhoc') }}"
                                          method="POST" >
            <label for="">Tìm kiếm môn học</label>
            <input type="text" name = "inputsearch" placeholder="MH1, Toán , ...." value = {{ inputsearch }}>
            <button type="submit" class = "btn btn-success">Tìm kiếm</button>
        </form>
    </div>
    <table class="table">
        <thead>
        <tr>
            <th>Mã môn học</th>
            <th>Tên môn học</th>
        </tr>
        </thead>
        <tbody>
        {% for monhoc in monhoc_data %}
            <tr>
                <td>{{ monhoc.MaMonHoc }}</td>
                <td>{{ monhoc.TenMonHoc }}</td>
                <td>

                    <button class="btn btn-danger" data-bs-toggle="modal"
                            data-bs-target="#modal_xoa_mon_{{ monhoc.MaMonHoc }}" id={{ monhoc.MaMonHoc }}
                    >Xóa
                    </button>
                    <div class="modal" id="modal_xoa_mon_{{ monhoc.MaMonHoc }}">
                        <div class="modal-dialog">
                            <div class="modal-content ">
                                <div class="modal-header">
                                    <h4 class="modal-title">Bạn có chắc chắn muốn xóa?</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>


                                <div class="modal-body">
                                    <strong>Lưu ý: </strong>khi xóa tất cá dữ liệu liên quan đến lớp xóa sẽ được xóa
                                    toàn bộ!!
                                    <div style="text-align: right">
                                        <button class="btn btn-danger" onclick="XoaMonHoc('{{ monhoc.MaMonHoc }}')">
                                            Xóa
                                        </button>
                                        <button class="btn btn-danger" data-bs-dismiss="modal">Hủy</button>
                                    </div>
                                </div>

                                <div class="modal-footer">

                                </div>

                            </div>
                        </div>
                    </div>
                </td>
                <td>

                    <button class="btn btn-success" data-bs-toggle="modal"
                            data-bs-target="#modal_sua_mon_{{ monhoc.MaMonHoc }}_{{ monhoc.TenMonHoc }}">Sửa
                    </button>
                    <div class="modal" id="modal_sua_mon_{{ monhoc.MaMonHoc }}_{{ monhoc.TenMonHoc }}">
                        <div class="modal-dialog">
                            <div class="modal-content ">
                                <div class="modal-header">
                                    <h4 class="modal-title">Thông tin môn học</h4>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>


                                <div class="modal-body">

                                    <form action="{{ url_for('.edit_monhoc', ma_monhoc=monhoc.MaMonHoc) }}"
                                          method="POST">

                                        <div>
                                            <label for="MaMonHoc">Mã môn học:</label>
                                            <input type="text" name="MaMonHoc" id="MaMonHoc"
                                                   value={{ monhoc.MaMonHoc }}>
                                        </div>
                                        <div>
                                            <label for="MaMonHoc">Mã môn học:</label>
                                            <input type="text" name="TenMonHoc" id="TenMonHoc"
                                                   value= {{ monhoc.TenMonHoc }}>
                                        </div>
                                        <button class="btn btn-success" type="submit"> Sửa</button>
                                    </form>


                                </div>

                                <div class="modal-footer">

                                </div>

                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <h3>Thêm Môn học </h3>
    <form method="POST" action="{{ url_for('.create_monhoc') }}">
        <label for="MaMonHoc">Mã môn học:</label>
        <input type="text" name="MaMonHoc" placeholder="Mã môn học..." required>
        <label for="TenMonHoc"></label>
        <input type="text" name="TenMonHoc" placeholder="Tên môn học..." required>

        <button type="submit" class="btn btn-primary">Thêm</button>
    </form>


    <h3>Danh sách khối</h3>
    <table class="table">
        <thead>
        <tr>
            <th>Mã khối</th>
            <th>Tên khối</th>
        </tr>
        </thead>
        <tbody>
        {% for khoi in dskhoi %}
            <tr>
                <td>{{ khoi.MaKhoi }}</td>
                <td>{{ khoi.TenKhoi }}</td>

            </tr>
        {% endfor %}
        </tbody>
    </table>




    <h3>Danh sách Môn học của Khối</h3>
    <table class="table">
        <thead>
        <tr>
            <th>Mã môn học</th>
            <th>Mã khối</th>
        </tr>
        </thead>
        <tbody>
        {% for record in monhoc_khoi_data %}
            <tr>
                <td>{{ record.MaMonHoc }}</td>
                <td>{{ record.MaKhoi }}</td>
                <td>
                    <form method="POST" action="{{ url_for('.delete_monhoc_khoi', id=record.Id) }}">
                        <button class="btn btn-danger" type="submit">Xóa</button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <h3>Thêm Môn học của Khối</h3>
    <form method="POST" action="{{ url_for('.create_monhoc_khoi') }}">
        <label for="MaMonHoc">Mã môn học:</label>
        <select name="MaMonHoc">
            {% for monhoc in monhoc_data %}
                <option value="{{ monhoc.MaMonHoc }}">{{ monhoc.TenMonHoc }}</option>
            {% endfor %}
        </select>

        <label for="MaKhoi">Mã khối:</label>
        <input type="text" name="MaKhoi" required>

        <button type="submit" class="btn btn-primary">Thêm</button>
    </form>


    <script>
        function XoaMonHoc(mamonhoc) {
            fetch(`/admin/monhockhoiview/${mamonhoc}`, {
                method: 'post',
                headers: {
                    'Content-Type': 'application/json',
                }
            }).then(response => response.json())
                .then(data => {
                    window.location.reload();
                })
        }

    </script>
{% endblock %}
